(this.webpackJsonpmovies=this.webpackJsonpmovies||[]).push([[0],{20:function(e,t,n){e.exports=n.p+"static/media/login.2ac8e864.svg"},4:function(e,t,n){var r={auth0_domain:"dev-cssxbqp4.auth0.com",auth0_client_id:"6e2uZ5yHXIMdQmnAVc7o7L7fE4qIh0I7",redirect_uri:"".concat(window.location.origin,"/home"),api_url:"http://localhost:8080",movie_key:"355b173760dcd00d231641df1ca54525",movie_api_url:"https://api.themoviedb.org/3"};e.exports=r},40:function(e,t,n){e.exports=n.p+"static/media/logo.2f6ed3a3.svg"},41:function(e,t,n){e.exports=n.p+"static/media/profile.5ec9cd16.svg"},42:function(e,t,n){e.exports=n(80)},47:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(37),i=n.n(c),o=(n(47),n(1)),s=n.n(o),u=n(3),l=n(10),m=n(11),d=n(13),p=n(12),v=n(14),f=n(8),h=n(4),g=n(23),b=n.n(g),S=n(16),E=n.n(S),x=a.a.createContext(),w=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(a)))).state={headerOptions:[{id:9,isSelected:!0,year:2019},{id:8,isSelected:!1,year:2018},{id:7,isSelected:!1,year:2017},{id:6,isSelected:!1,year:2016},{id:5,isSelected:!1,year:2015},{id:4,isSelected:!1,year:2014},{id:3,isSelected:!1,year:2013},{id:2,isSelected:!1,year:2012},{id:1,isSelected:!1,year:2011},{id:0,isSelected:!1,year:2010}],currentYear:2019,currentSearch:"a",auth0Client:null,isLoading:!0,user:null,isAuthenticated:!1,movies:[],currentMovie:{id:null,release_date:null,title:null,overview:null,poster_path:null,score:[{id:1,isSelected:!1},{id:2,isSelected:!1},{id:3,isSelected:!1},{id:4,isSelected:!1},{id:5,isSelected:!1}],currentScore:0,comments:[],currentComment:""}},n.selectHeaderOption=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({headerOptions:[{id:9,isSelected:2019===t,year:2019},{id:8,isSelected:2018===t,year:2018},{id:7,isSelected:2017===t,year:2017},{id:6,isSelected:2016===t,year:2016},{id:5,isSelected:2015===t,year:2015},{id:4,isSelected:2014===t,year:2014},{id:3,isSelected:2013===t,year:2013},{id:2,isSelected:2012===t,year:2012},{id:1,isSelected:2011===t,year:2011},{id:0,isSelected:2010===t,year:2010}],currentYear:t}),e.next=3,n.initMovies(t,n.state.currentSearch);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setCurrentSearch=function(){var e=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t&&""!==t?t:"a",n.setState({currentSearch:r}),e.next=4,n.initMovies(n.state.currentYear,r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setCurrentMovie=function(){var e=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.initCurrentMovie(t);case 2:return r=e.sent,e.next=5,n.updateScoreAndComments(r);case 5:n.props.history.push("/movie/".concat(t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setMovieScore=function(){var e=Object(u.a)(s.a.mark((function e(t){var r,a,c,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.state.currentMovie,a=r.currentScore,c=r.score,t===a&&t--,i=c.map((function(e){return e.id<=t?e.isSelected=!0:e.isSelected=!1,e})),(o=n.state.currentMovie).score=i,o.currentScore=t,n.setState({currentMovie:o}),e.next=9,n.save(o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setMovieComment=function(){var e=Object(u.a)(s.a.mark((function e(t){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.state.currentMovie.id,(a=n.state.currentMovie).currentComment=t,n.setState({currentMovie:a}),e.next=6,n.save({id:r,comment:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.save=function(){var e=Object(u.a)(s.a.mark((function e(t){var r,a,c,i,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,a=t.currentScore,c=t.comment,i=n.state.user.email,e.next=4,n.getInfoMovies(r,i);case 4:if(o=e.sent,u={movie:r,user:i,score:a,comment:c},!(o&&o.length>0)){e.next=11;break}return e.next=9,n.updateInfoMovies(u);case 9:e.next=13;break;case 11:return e.next=13,n.saveInfoMovies(u);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getInfoMovies=function(e,t){try{return E.a.get("".concat(h.api_url,"/movies/?movie=").concat(e,"&user=").concat(t)).then((function(e){return e.data})).catch((function(e){return console.error("error ".concat(e))}))}catch(n){console.error(n)}},n.saveInfoMovies=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.post("".concat(h.api_url,"/movies"),t).then((function(e){return e.data})).catch((function(e){return console.error("error ".concat(e))}));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),n.updateInfoMovies=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.movie,r=t.user,a=t.score,c=t.comment,e.prev=1,e.next=4,E.a.put("".concat(h.api_url,"/movies/").concat(n,"/").concat(r),{score:a,comment:c}).then((function(e){return e.data})).catch((function(e){return console.error("error ".concat(e))}));case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),n.initializeAuth0=Object(u.a)(s.a.mark((function e(){var t,r,a,c,i,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(localStorage.getItem("user"))){e.next=23;break}return e.next=4,b()({domain:h.auth0_domain,client_id:h.auth0_client_id,redirect_uri:h.redirect_uri});case 4:if(r=e.sent,n.setState({auth0Client:r}),!window.location.search.includes("code=")){e.next=8;break}return e.abrupt("return",n.handleRedirectCallback());case 8:return e.next=10,r.isAuthenticated();case 10:if(!(a=e.sent)){e.next=17;break}return e.next=14,r.getUser();case 14:e.t0=e.sent,e.next=18;break;case 17:e.t0=null;case 18:c=e.t0,n.setState({user:c,isLoading:!1,isAuthenticated:a}),c&&localStorage.setItem("user",JSON.stringify(c)),e.next=27;break;case 23:return i=n.state,o=i.currentYear,u=i.currentSearch,e.next=26,n.initMovies(o,u);case 26:n.setState({user:t,isAuthenticated:!0,isLoading:!1});case 27:case"end":return e.stop()}}),e)}))),n.initMovies=function(){var e=Object(u.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{E.a.get("".concat(h.movie_api_url,"/search/movie?api_key=").concat(h.movie_key,"&query=").concat(r,"&page=1&region=US&year=").concat(t)).then((function(e){n.setState({movies:e.data})})).catch((function(e){return console.error("error ".concat(e))}))}catch(a){console.log(a)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.initCurrentMovie=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.get("".concat(h.movie_api_url,"/movie/").concat(t,"?api_key=").concat(h.movie_key)).then((function(e){var t=e.data,r={id:t.id,release_date:t.release_date,title:t.title,overview:t.overview,poster_path:t.poster_path,score:[{id:1,isSelected:!1},{id:2,isSelected:!1},{id:3,isSelected:!1},{id:4,isSelected:!1},{id:5,isSelected:!1}],comments:[]};return n.setState({currentMovie:r}),r})).catch((function(e){return console.error("error ".concat(e))}));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),n.updateScoreAndComments=function(){var e=Object(u.a)(s.a.mark((function e(t){var r,a,c,i,o,u,l,m,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,n.getInfoMovies(r);case 3:a=e.sent,c=n.state.user,a&&(i=a.filter((function(e){return e.user!==c.email})),o=a.find((function(e){return e.user===c.email&&e.movie===r.toString()})),(u=t).comments=i,o&&(l=o.score,m=o.comment,d=t.score.map((function(e){return e.id<=l?e.isSelected=!0:e.isSelected=!1,e})),u.score=d,u.currentComment=m),n.setState({currentMovie:u}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleRedirectCallback=Object(u.a)(s.a.mark((function e(){var t,r,a,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),t=n.state.auth0Client,e.next=4,t.handleRedirectCallback();case 4:return e.next=6,t.getUser();case 6:if(!(r=e.sent)){e.next=13;break}return a=n.state,c=a.currentYear,i=a.currentSearch,e.next=11,n.initMovies(c,i);case 11:n.setState({user:r,isAuthenticated:!0,isLoading:!1}),localStorage.setItem("user",JSON.stringify(r));case 13:window.history.replaceState({},document.title,window.location.pathname);case 14:case"end":return e.stop()}}),e)}))),n.logout=function(){var e=Object(u.a)(s.a.mark((function e(){var t,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b()({domain:h.auth0_domain,client_id:h.auth0_client_id,redirect_uri:h.redirect_uri});case 2:t=e.sent,localStorage.clear(),t.logout.apply(t,n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.componentDidMount=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.scrollTo(0,0),e.next=3,n.initializeAuth0();case 3:case"end":return e.stop()}}),e)}))),n.componentWillMount=Object(u.a)(s.a.mark((function e(){var t,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.props.history.location.pathname).includes("movie")){e.next=8;break}return r=t.split("/").pop(),e.next=5,n.initCurrentMovie(r);case 5:return a=e.sent,e.next=8,n.updateScoreAndComments(a);case 8:case"end":return e.stop()}}),e)}))),n}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state,t=e.auth0Client,n=e.isLoading,r=e.isAuthenticated,c=e.headerOptions,i={isLoading:n,isAuthenticated:r,user:e.user,movies:e.movies,currentMovie:e.currentMovie,selectHeaderOption:this.selectHeaderOption,setCurrentMovie:this.setCurrentMovie,setMovieScore:this.setMovieScore,setMovieComment:this.setMovieComment,headerOptions:c,setCurrentSearch:this.setCurrentSearch,loginWithRedirect:function(){return t.loginWithRedirect.apply(t,arguments)},getTokenSilently:function(){return t.getTokenSilently.apply(t,arguments)},getIdTokenClaims:function(){return t.getIdTokenClaims.apply(t,arguments)},logout:this.logout};return a.a.createElement(x.Provider,{value:i},this.props.children)}}]),t}(r.Component),y=Object(f.f)(w),k=x,C=n(18),N=(n(71),n(72),function(e){var t=e.image,n=e.name,r=e.setProfileState,c=e.logout;return a.a.createElement("div",{className:"profile-box"},a.a.createElement("div",{className:"profile-header"},a.a.createElement("i",{className:"material-icons",onClick:function(){return r()}},"close")),a.a.createElement("div",{className:"profile-content"},a.a.createElement("img",{className:"profile-img",src:t,alt:"profile-img"}),a.a.createElement("p",{className:"profile-name"},n)),a.a.createElement("div",{className:"profile-exit",onClick:function(){return c()}},a.a.createElement("i",{className:"material-icons"},"exit_to_app"),a.a.createElement("p",{className:"profile-logout"},"Log out")))}),O=n(40),M=n.n(O),j=n(41),_=n.n(j),A=n(20),I=n.n(A),W=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).setProfileState=function(){var e=n.state.profile;n.setState({profile:!e})},n.state={profile:!1},n}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.profile,n=this.props.context,r=a.a.createElement("section",{className:"header-wrap"},a.a.createElement(C.b,{to:"/home",className:"header-left"},a.a.createElement("img",{className:"header-left-logo",src:M.a,alt:"logo"}),a.a.createElement("p",{className:"header-left-name"},n.isAuthenticated?n.user.given_name:"Welcome to MOVIES")),a.a.createElement("div",{className:"header-right"},n.isAuthenticated?a.a.createElement("img",{className:"header-right-profile",src:_.a,alt:"profile_img",onClick:function(){return e.setProfileState()}}):a.a.createElement("img",{className:"header-right-profile",src:I.a,alt:"login",onClick:n.loginWithRedirect}),a.a.createElement("div",null,t?a.a.createElement(N,{name:n.user.name,image:n.user.picture,logout:n.logout,setProfileState:this.setProfileState}):"")));return a.a.createElement("div",{className:"header-box"},r)}}]),t}(r.Component),L=n(21),R=(n(73),n(74),function(e){var t=e.image,n=e.date,r=e.title,c="https://image.tmdb.org/t/p/w500".concat(t);return a.a.createElement("div",{className:"movieCard-box"},a.a.createElement("img",{className:"movieCard-img",src:c,alt:"movieCard-img"}),a.a.createElement("p",{className:"movieCard-date"},n),a.a.createElement("p",{className:"movieCard-title"},r))}),P=function(e){var t=e.context,n=Object(r.useState)("a"),c=Object(L.a)(n,2),i=c[0],o=c[1],l=function(){var e=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(n),e.next=3,t.setCurrentSearch(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"dashboard-box"},t&&a.a.createElement("section",{className:"dashboard-wrap"},a.a.createElement("div",{className:"dashboard-controls"},a.a.createElement("ul",{className:"dashboard-years"},t.headerOptions.map((function(e,n){return a.a.createElement("li",{className:"dashboard-options ".concat(e.isSelected?"isSelected":""," "),key:n,onClick:function(){return t.selectHeaderOption(e.year)}},e.year)}))),a.a.createElement("div",{className:"dashboard-search-wrap"},a.a.createElement("input",{id:"search-1",value:i,className:"dashboard-search-input",onChange:function(e){return l(e.target.value)}}),a.a.createElement("i",{className:"material-icons"},"search"))),a.a.createElement("div",{className:"dashboard-content"},t.movies.results&&t.movies.results.map((function(e,n){return a.a.createElement("div",{key:n,onClick:function(){return t.setCurrentMovie(e.id)}},a.a.createElement(R,{image:e.poster_path,date:e.release_date,title:e.title}))})))))},T=(n(75),function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"loging-box"},a.a.createElement(k.Consumer,null,(function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",{className:"loging-text"},"Please click on the CINEMA studio icon to login"),a.a.createElement("img",{className:"loging-img",onClick:e.loginWithRedirect,src:I.a,alt:"login-img"}))})))}}]),t}(r.Component)),B=(n(76),function(e){var t=e.backgroundColor,n=e.textColor,r=e.text,c=e.icon,i=e.setMovieComment,o=e.comment;return a.a.createElement("div",{className:"cutomButton-box",style:{backgroundColor:"".concat(t),color:"".concat(n)},onClick:function(){return i(o)}},r?a.a.createElement("p",{className:"cutomButton-tex"},r):"",a.a.createElement("div",null,c?a.a.createElement("i",{className:"material-icons cutomButton-icon "},c):""))}),U=(n(77),function(e){var t=e.context,n=Object(r.useState)(""),c=Object(L.a)(n,2),i=c[0],o=c[1];Object(r.useEffect)((function(){var e=document.getElementById("textarea-1");e&&t.currentMovie.currentComment&&(e.value=t.currentMovie.currentComment)}));var s,u=function(e){o(e),t.setMovieComment(e)};return a.a.createElement("div",{className:"movie-box"},t.currentMovie.id&&a.a.createElement("section",{className:"movie-wrap"},a.a.createElement("div",{className:"movie-header"},a.a.createElement("div",{className:"movie-left"},a.a.createElement("img",{className:"movie-img",src:(s=t.currentMovie.poster_path,"https://image.tmdb.org/t/p/w500".concat(s)),alt:"movieCard-img"})),a.a.createElement("div",{className:"movie-right"},a.a.createElement("h1",{className:"movie-title"},t.currentMovie.title),a.a.createElement("p",{className:"movie-date"},t.currentMovie.release_date),a.a.createElement("p",{className:"movie-overview"},t.currentMovie.overview),a.a.createElement("ul",{className:"movie-score"},t.currentMovie.score.map((function(e,n){return a.a.createElement("li",{key:n,className:"movie-start",onClick:function(){return t.setMovieScore(e.id)}},e.isSelected?a.a.createElement("i",{className:"material-icons isSelected"},"star"):a.a.createElement("i",{className:"material-icons"},"star"))}))),a.a.createElement("div",{className:"movie-comment"},a.a.createElement("textarea",{id:"textarea-1",value:i,className:"movie-text-comment",onChange:function(e){return o(e.target.value)}}),a.a.createElement("div",{className:"movie-comment-buttons"},a.a.createElement(B,{backgroundColor:"#439f9a",textColor:"#ffffff",icon:"add_comment",setMovieComment:u,comment:i}),a.a.createElement(B,{backgroundColor:"#ea3e3c",textColor:"#ffffff",icon:"delete",setMovieComment:u,comment:""}))))),t.currentMovie.comments&&a.a.createElement("ul",{className:"movie-others-comments"},t.currentMovie.comments.map((function(e,t){return a.a.createElement("li",{key:t,className:"movie-other-users"},a.a.createElement("p",{className:"movie-others-comments-user"},e.user),a.a.createElement("p",{className:"movie-others-comments-comment"},e.comment))})))))}),H=(n(78),function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"home-box"},a.a.createElement(k.Consumer,null,(function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(W,{context:e}),a.a.createElement(f.c,null,e.isAuthenticated?a.a.createElement(f.a,{exact:!0,path:"/",render:function(t){return a.a.createElement(P,Object.assign({},t,{context:e}))}}):a.a.createElement(f.a,{exact:!0,path:"/",component:T}),a.a.createElement(f.a,{exact:!0,path:"/login",component:T}),a.a.createElement(f.a,{exact:!0,path:"/home",render:function(t){return a.a.createElement(P,Object.assign({},t,{context:e}))}}),a.a.createElement(f.a,{exact:!0,path:"/movie/:id",render:function(t){return a.a.createElement(U,Object.assign({},t,{context:e}))}}),a.a.createElement(f.a,{component:T})))})))}}]),t}(r.Component));var J=function(){return a.a.createElement("div",{className:"App"},a.a.createElement(y,null,a.a.createElement(H,null)))},Y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function q(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(79);i.a.render(a.a.createElement(C.a,null,a.a.createElement(J,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Y?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):q(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):q(t,e)}))}}()}},[[42,1,2]]]);
//# sourceMappingURL=main.dc7d7f8a.chunk.js.map