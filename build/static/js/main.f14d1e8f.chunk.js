(this.webpackJsonpmovies=this.webpackJsonpmovies||[]).push([[0],{20:function(e,t,a){e.exports=a.p+"static/media/login.2ac8e864.svg"},4:function(e,t,a){var n={auth0_domain:"dev-cssxbqp4.auth0.com",auth0_client_id:"6e2uZ5yHXIMdQmnAVc7o7L7fE4qIh0I7",redirect_uri:"".concat(window.location.origin,"/home"),api_url:"http://localhost:8080",movie_key:"355b173760dcd00d231641df1ca54525",movie_api_url:"https://api.themoviedb.org/3"};e.exports=n},40:function(e,t,a){e.exports=a.p+"static/media/logo.2f6ed3a3.svg"},41:function(e,t,a){e.exports=a.p+"static/media/profile.5ec9cd16.svg"},43:function(e,t,a){e.exports=a(81)},48:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){},79:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(37),i=a.n(c),o=(a(48),a(1)),s=a.n(o),u=a(3),l=a(10),m=a(11),d=a(13),p=a(12),v=a(14),f=a(8),h=a(4),g=a(23),E=a.n(g),S=a(16),b=a.n(S),x=r.a.createContext(),y=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={headerOptions:[{id:9,isSelected:!0,year:2019},{id:8,isSelected:!1,year:2018},{id:7,isSelected:!1,year:2017},{id:6,isSelected:!1,year:2016},{id:5,isSelected:!1,year:2015},{id:4,isSelected:!1,year:2014},{id:3,isSelected:!1,year:2013},{id:2,isSelected:!1,year:2012},{id:1,isSelected:!1,year:2011},{id:0,isSelected:!1,year:2010}],currentYear:2019,currentSearch:"a",auth0Client:null,isLoading:!0,user:null,isAuthenticated:!1,showLoading:!1,movies:[],currentMovie:{id:null,release_date:null,title:null,overview:null,poster_path:null,score:[{id:1,isSelected:!1},{id:2,isSelected:!1},{id:3,isSelected:!1},{id:4,isSelected:!1},{id:5,isSelected:!1}],currentScore:0,comments:[],currentComment:""}},a.selectHeaderOption=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({headerOptions:[{id:9,isSelected:2019===t,year:2019},{id:8,isSelected:2018===t,year:2018},{id:7,isSelected:2017===t,year:2017},{id:6,isSelected:2016===t,year:2016},{id:5,isSelected:2015===t,year:2015},{id:4,isSelected:2014===t,year:2014},{id:3,isSelected:2013===t,year:2013},{id:2,isSelected:2012===t,year:2012},{id:1,isSelected:2011===t,year:2011},{id:0,isSelected:2010===t,year:2010}],currentYear:t}),e.next=3,a.initMovies(t,a.state.currentSearch);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setCurrentSearch=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t&&""!==t?t:"a",a.setState({currentSearch:n}),e.next=4,a.initMovies(a.state.currentYear,n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setCurrentMovie=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.initCurrentMovie(t);case 2:return n=e.sent,e.next=5,a.updateScoreAndComments(n);case 5:a.props.history.push("/movie/".concat(t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setMovieScore=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,c,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.currentMovie,r=n.currentScore,c=n.score,t===r&&t--,i=c.map((function(e){return e.id<=t?e.isSelected=!0:e.isSelected=!1,e})),(o=a.state.currentMovie).score=i,o.currentScore=t,a.setState({currentMovie:o}),e.next=9,a.save(o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setMovieComment=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.currentMovie.id,(r=a.state.currentMovie).currentComment=t,a.setState({currentMovie:r,showLoading:!0}),e.next=6,a.save({id:n,comment:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.save=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,c,i,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.currentScore,c=t.comment,i=a.state.user.email,e.next=4,a.getInfoMovies(n,i);case 4:if(o=e.sent,u={movie:n,user:i,score:r,comment:c},!(o&&o.length>0)){e.next=11;break}return e.next=9,a.updateInfoMovies(u);case 9:e.next=13;break;case 11:return e.next=13,a.saveInfoMovies(u);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getInfoMovies=function(e,t){try{return b.a.get("".concat(h.api_url,"/movies/?movie=").concat(e,"&user=").concat(t)).then((function(e){return e.data})).catch((function(e){return console.error("error ".concat(e))}))}catch(a){console.error(a)}},a.saveInfoMovies=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(h.api_url,"/movies"),t).then((function(e){return a.setState({showLoading:!1}),e.data})).catch((function(e){return console.error("error ".concat(e))}));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),a.updateInfoMovies=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.movie,r=t.user,c=t.score,i=t.comment,e.prev=1,e.next=4,b.a.put("".concat(h.api_url,"/movies/").concat(n,"/").concat(r),{score:c,comment:i}).then((function(e){return a.setState({showLoading:!1}),e.data})).catch((function(e){return console.error("error ".concat(e))}));case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),a.initializeAuth0=Object(u.a)(s.a.mark((function e(){var t,n,r,c,i,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(localStorage.getItem("user"))){e.next=23;break}return e.next=4,E()({domain:h.auth0_domain,client_id:h.auth0_client_id,redirect_uri:h.redirect_uri});case 4:if(n=e.sent,a.setState({auth0Client:n}),!window.location.search.includes("code=")){e.next=8;break}return e.abrupt("return",a.handleRedirectCallback());case 8:return e.next=10,n.isAuthenticated();case 10:if(!(r=e.sent)){e.next=17;break}return e.next=14,n.getUser();case 14:e.t0=e.sent,e.next=18;break;case 17:e.t0=null;case 18:c=e.t0,a.setState({user:c,isLoading:!1,isAuthenticated:r}),c&&localStorage.setItem("user",JSON.stringify(c)),e.next=27;break;case 23:return i=a.state,o=i.currentYear,u=i.currentSearch,e.next=26,a.initMovies(o,u);case 26:a.setState({user:t,isAuthenticated:!0,isLoading:!1});case 27:case"end":return e.stop()}}),e)}))),a.initMovies=function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{b.a.get("".concat(h.movie_api_url,"/search/movie?api_key=").concat(h.movie_key,"&query=").concat(n,"&page=1&region=US&year=").concat(t)).then((function(e){a.setState({movies:e.data})})).catch((function(e){return console.error("error ".concat(e))}))}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.initCurrentMovie=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("".concat(h.movie_api_url,"/movie/").concat(t,"?api_key=").concat(h.movie_key)).then((function(e){var t=e.data,n={id:t.id,release_date:t.release_date,title:t.title,overview:t.overview,poster_path:t.poster_path,score:[{id:1,isSelected:!1},{id:2,isSelected:!1},{id:3,isSelected:!1},{id:4,isSelected:!1},{id:5,isSelected:!1}],comments:[]};return a.setState({currentMovie:n}),n})).catch((function(e){return console.error("error ".concat(e))}));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),a.updateScoreAndComments=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,c,i,o,u,l,m,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,a.getInfoMovies(n);case 3:r=e.sent,c=a.state.user,r&&(i=r.filter((function(e){return e.user!==c.email&&e.comment})),o=r.find((function(e){return e.user===c.email&&e.movie===n.toString()})),(u=t).comments=i,o&&(l=o.score,m=o.comment,d=t.score.map((function(e){return e.id<=l?e.isSelected=!0:e.isSelected=!1,e})),u.score=d,u.currentComment=m),a.setState({currentMovie:u}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleRedirectCallback=Object(u.a)(s.a.mark((function e(){var t,n,r,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isLoading:!0}),t=a.state.auth0Client,e.next=4,t.handleRedirectCallback();case 4:return e.next=6,t.getUser();case 6:if(!(n=e.sent)){e.next=13;break}return r=a.state,c=r.currentYear,i=r.currentSearch,e.next=11,a.initMovies(c,i);case 11:a.setState({user:n,isAuthenticated:!0,isLoading:!1}),localStorage.setItem("user",JSON.stringify(n));case 13:window.history.replaceState({},document.title,window.location.pathname);case 14:case"end":return e.stop()}}),e)}))),a.logout=function(){var e=Object(u.a)(s.a.mark((function e(){var t,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E()({domain:h.auth0_domain,client_id:h.auth0_client_id,redirect_uri:h.redirect_uri});case 2:t=e.sent,localStorage.clear(),t.logout.apply(t,a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a.componentDidMount=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.scrollTo(0,0),e.next=3,a.initializeAuth0();case 3:case"end":return e.stop()}}),e)}))),a.componentWillMount=Object(u.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.props.history.location.pathname).includes("movie")){e.next=8;break}return n=t.split("/").pop(),e.next=5,a.initCurrentMovie(n);case 5:return r=e.sent,e.next=8,a.updateScoreAndComments(r);case 8:case"end":return e.stop()}}),e)}))),a}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state,t=e.auth0Client,a=e.isLoading,n=e.isAuthenticated,c=e.headerOptions,i={isLoading:a,isAuthenticated:n,user:e.user,movies:e.movies,currentMovie:e.currentMovie,showLoading:e.showLoading,selectHeaderOption:this.selectHeaderOption,setCurrentMovie:this.setCurrentMovie,setMovieScore:this.setMovieScore,setMovieComment:this.setMovieComment,headerOptions:c,setCurrentSearch:this.setCurrentSearch,loginWithRedirect:function(){return t.loginWithRedirect.apply(t,arguments)},getTokenSilently:function(){return t.getTokenSilently.apply(t,arguments)},getIdTokenClaims:function(){return t.getIdTokenClaims.apply(t,arguments)},logout:this.logout};return r.a.createElement(x.Provider,{value:i},this.props.children)}}]),t}(n.Component),C=Object(f.f)(y),w=x,N=a(18),k=(a(72),a(73),function(e){var t=e.image,a=e.name,n=e.setProfileState,c=e.logout;return r.a.createElement("div",{className:"profile-box"},r.a.createElement("div",{className:"profile-header"},r.a.createElement("i",{className:"material-icons",onClick:function(){return n()}},"close")),r.a.createElement("div",{className:"profile-content"},r.a.createElement("img",{className:"profile-img",src:t,alt:"profile-img"}),r.a.createElement("p",{className:"profile-name"},a)),r.a.createElement("div",{className:"profile-exit",onClick:function(){return c()}},r.a.createElement("i",{className:"material-icons"},"exit_to_app"),r.a.createElement("p",{className:"profile-logout"},"Log out")))}),O=a(40),M=a.n(O),j=a(41),_=a.n(j),I=a(20),A=a.n(I),L=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).setProfileState=function(){var e=a.state.profile;a.setState({profile:!e})},a.state={profile:!1},a}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.profile,a=this.props.context,n=r.a.createElement("section",{className:"header-wrap"},r.a.createElement(N.b,{to:"/home",className:"header-left"},r.a.createElement("img",{className:"header-left-logo",src:M.a,alt:"logo"}),r.a.createElement("p",{className:"header-left-name"},a.isAuthenticated?a.user.given_name:"Welcome to MOVIES")),r.a.createElement("div",{className:"header-right"},a.isAuthenticated?r.a.createElement("img",{className:"header-right-profile",src:_.a,alt:"profile_img",onClick:function(){return e.setProfileState()}}):r.a.createElement("img",{className:"header-right-profile",src:A.a,alt:"login",onClick:a.loginWithRedirect}),r.a.createElement("div",null,t?r.a.createElement(k,{name:a.user.name,image:a.user.picture,logout:a.logout,setProfileState:this.setProfileState}):"")));return r.a.createElement("div",{className:"header-box"},n)}}]),t}(n.Component),B=a(21),P=(a(74),a(75),function(e){var t=e.image,a=e.date,n=e.title,c="https://image.tmdb.org/t/p/w500".concat(t);return r.a.createElement("div",{className:"movieCard-box"},r.a.createElement("img",{className:"movieCard-img",src:c,alt:"movieCard-img"}),r.a.createElement("p",{className:"movieCard-date"},a),r.a.createElement("p",{className:"movieCard-title"},n))}),R=function(e){var t=e.context,a=Object(n.useState)("a"),c=Object(B.a)(a,2),i=c[0],o=c[1],l=function(){var e=Object(u.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(a),e.next=3,t.setCurrentSearch(a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"dashboard-box"},t&&r.a.createElement("section",{className:"dashboard-wrap"},r.a.createElement("div",{className:"dashboard-controls"},r.a.createElement("ul",{className:"dashboard-years"},t.headerOptions.map((function(e,a){return r.a.createElement("li",{className:"dashboard-options ".concat(e.isSelected?"isSelected":""," "),key:a,onClick:function(){return t.selectHeaderOption(e.year)}},e.year)}))),r.a.createElement("div",{className:"dashboard-search-wrap"},r.a.createElement("input",{id:"search-1",value:i,className:"dashboard-search-input",onChange:function(e){return l(e.target.value)}}),r.a.createElement("i",{className:"material-icons"},"search"))),r.a.createElement("div",{className:"dashboard-content"},t.movies.results&&t.movies.results.map((function(e,a){return r.a.createElement("div",{key:a,onClick:function(){return t.setCurrentMovie(e.id)}},r.a.createElement(P,{image:e.poster_path,date:e.release_date,title:e.title}))})))))},W=(a(76),function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"loging-box"},r.a.createElement(w.Consumer,null,(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"loging-text"},"Please click on the CINEMA studio icon to login"),r.a.createElement("img",{className:"loging-img",onClick:e.loginWithRedirect,src:A.a,alt:"login-img"}))})))}}]),t}(n.Component)),H=a(42),J=a.n(H),T=(a(77),function(e){var t=e.backgroundColor,a=e.textColor,n=e.text,c=e.icon,i=e.setMovieComment;return r.a.createElement("div",{className:"cutomButton-box",style:{backgroundColor:"".concat(t),color:"".concat(a)},onClick:function(){return i()}},n?r.a.createElement("p",{className:"cutomButton-tex"},n):"",r.a.createElement("div",null,c?r.a.createElement("i",{className:"material-icons cutomButton-icon "},c):""))}),Y=(a(78),function(e){var t=e.context,a=Object(n.useState)(""),c=Object(B.a)(a,2),i=c[0],o=c[1];Object(n.useEffect)((function(){var e=document.getElementById("textarea-1");e&&t.currentMovie.currentComment&&(e.value=t.currentMovie.currentComment)}));var s;return r.a.createElement("div",{className:"movie-box"},t.currentMovie.id&&r.a.createElement("section",{className:"movie-wrap"},r.a.createElement("div",{className:"movie-header"},r.a.createElement("div",{className:"movie-left"},r.a.createElement("img",{className:"movie-img",src:(s=t.currentMovie.poster_path,"https://image.tmdb.org/t/p/w500".concat(s)),alt:"movieCard-img"})),r.a.createElement("div",{className:"movie-right"},r.a.createElement("h1",{className:"movie-title"},t.currentMovie.title),r.a.createElement("p",{className:"movie-date"},t.currentMovie.release_date),r.a.createElement("p",{className:"movie-overview"},t.currentMovie.overview),r.a.createElement("ul",{className:"movie-score"},t.currentMovie.score.map((function(e,a){return r.a.createElement("li",{key:a,className:"movie-start",onClick:function(){return t.setMovieScore(e.id)}},e.isSelected?r.a.createElement("i",{className:"material-icons isSelected"},"star"):r.a.createElement("i",{className:"material-icons"},"star"))}))),r.a.createElement("div",{className:"movie-comment"},r.a.createElement("textarea",{id:"textarea-1",value:i,className:"movie-text-comment",onChange:function(e){return o(e.target.value)}}),t.showLoading?r.a.createElement("div",{className:"reactLoading-wrap"},r.a.createElement(J.a,{className:"reactLoading-img",type:"bars",color:"#439f9a",height:33})):r.a.createElement("div",{className:"movie-comment-buttons"},r.a.createElement(T,{backgroundColor:"#439f9a",textColor:"#ffffff",icon:"add_comment",setMovieComment:function(){var e=document.getElementById("textarea-1");e&&e.value&&(o(e.value),t.setMovieComment(e.value))}}),r.a.createElement(T,{backgroundColor:"#ea3e3c",textColor:"#ffffff",icon:"delete",setMovieComment:function(){var e=document.getElementById("textarea-1");e&&e.value&&(o(""),t.setMovieComment(""))}}))))),t.currentMovie.comments&&r.a.createElement("ul",{className:"movie-others-comments"},t.currentMovie.comments.map((function(e,t){return r.a.createElement("li",{key:t,className:"movie-other-users"},r.a.createElement("p",{className:"movie-others-comments-user"},e.user),r.a.createElement("p",{className:"movie-others-comments-comment"},e.comment))})))))}),q=(a(79),function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"home-box"},r.a.createElement(w.Consumer,null,(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{context:e}),r.a.createElement(f.c,null,e.isAuthenticated?r.a.createElement(f.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(R,Object.assign({},t,{context:e}))}}):r.a.createElement(f.a,{exact:!0,path:"/",component:W}),r.a.createElement(f.a,{exact:!0,path:"/login",component:W}),r.a.createElement(f.a,{exact:!0,path:"/home",render:function(t){return r.a.createElement(R,Object.assign({},t,{context:e}))}}),r.a.createElement(f.a,{exact:!0,path:"/movie/:id",render:function(t){return r.a.createElement(Y,Object.assign({},t,{context:e}))}}),r.a.createElement(f.a,{component:W})))})))}}]),t}(n.Component));var U=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(C,null,r.a.createElement(q,null)))};a(80);i.a.render(r.a.createElement(N.a,null,r.a.createElement(U,null)),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.f14d1e8f.chunk.js.map